var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Main=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isThemeLoadEnd=!1,e.isResourceLoadEnd=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this);var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/"),EXML.load("resource/components/showValue.exml",this.onLoadDispValueCompeleted,this,!0),EXML.load("resource/components/register.exml",this.onLoadRegisterCompeleted,this,!0),this.initSocket()},e.prototype.onLoadRegisterCompeleted=function(t,e){this._regLoginPage=new eui.Panel,this._regLoginPage.skinName=t;var i=this.stage.stageWidth,n=this.stage.stageHeight,s=this.globalToLocal(0,0);this._regLoginPage.x=s.x,this._regLoginPage.y=s.y,this._regLoginPage.width=i,this._regLoginPage.height=n;var a=this._regLoginPage.getChildAt(5),o=this._regLoginPage.getChildAt(6);a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.login,this),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.register,this)},e.prototype.onLoadDispValueCompeleted=function(t,e){this._dispValue=new eui.Panel,this._dispValue.skinName=t,this._dispValue.y=.3*Data.getStageH();var i=this._dispValue.getChildAt(2),n=this._dispValue.getChildAt(1);i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.retryGame,this),n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackBtnClick,this)},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},e.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},e.prototype.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},e.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.initSocketWithUrl=function(t){this._socket=io.connect(t);var e=new UserHandler(this._socket);e.setLoginSuccessHandler(this.onLoginSuccess.bind(this)),e.setRegisterSuccessHandler(this.onRegister.bind(this)),e.setExceptionHandler(this.onException.bind(this)),e.setGameStopHandler(this.onGameStop.bind(this)),e.setGameBeginsHandler(this.onGameBegins.bind(this)),e.setqueryCurMatchResult(this.onQueryCurMatchResult.bind(this)),e.initHandler()},e.prototype.initSocket=function(){this.initSocketWithUrl("http://52.15.214.55:8091/")},e.prototype.startCreateScene=function(){var t=this.createBitmapByName("appBg_jpg");this.addChild(t);var e=this.stage.stageWidth,i=this.stage.stageHeight;t.width=e,t.height=i;var n=new eui.Button;n.label="单机模式",n.width=200,n.height=70,this.btn2=new eui.Button,this.btn2.label="联机比赛",this.btn2.width=200,this.btn2.height=70;var s=new eui.Button;s.label="登陆/注册",s.width=200,s.height=70,this.btn4=new eui.Button,this.btn4.label="你不能点的按钮 :)",this.btn4.width=200,this.btn4.height=70,this.btn4.enabled=!1,this.addChild(n),this.addChild(this.btn2),this.addChild(s),this.addChild(this.btn4);var a=new eui.VerticalLayout;a.gap=10,a.paddingTop=380,a.horizontalAlign=egret.HorizontalAlign.CENTER,this.layout=a,n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSingleGameClick,this),this.btn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMultiGameBtnClick,this),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRegLoginBtnClick,this),this.btn4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.dispAdminPanel,this),this._runingPage=new egret.DisplayObjectContainer,this._backBtn=new eui.Button,this._backBtn.label=">> 返回主页 <<",this._backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackBtnClick,this),this._lastCount=new egret.TextField,this._lastCount.backgroundColor=16777215,this._lastCount.border=!1,this._lastCount.borderColor=65280,this._lastCount.fontFamily="Arial",this._lastCount.textColor=0,this._lastCount.size=60,this._lastCount.text="倒计时：",this._lastCount.x=.5*Data.getStageW(),this._lastCount.y=.2*Data.getStageH(),this._resultPanel=new eui.Panel;var o=new egret.TextField;o.text="得分："+Data.score.toString(),this._runingPage.addChild(this._lastCount),this._runingPage.addChild(this._backBtn)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.startAnimation=function(t){},e.prototype.onSingleGameClick=function(t){console.log("[INFO] 单机模式开始！ "),this._gameType="singleUser",this.gameStart()},e.prototype.onMultiGameBtnClick=function(t){return console.log("[INFO] 多人模式开始！ "),this._gameType="multiUser",null==Data._user?void(this.btn2.enabled=!1):void this.gameStart()},e.prototype.gameStart=function(){var t=this;"singleUser"==this._gameType?(this.addChild(this._runingPage),this._singleUsergame=new Game(this._runingPage),this._singleUsergame.start(),this._runingPage.setChildIndex(this._backBtn,-1),this._runingPage.setChildIndex(this._lastCount,-1),this._time=new egret.Timer(1e3,60),Data.remainTime=60,this._time.addEventListener(egret.TimerEvent.TIMER,this.timerDecount,this),this._time.start()):"multiUser"==this._gameType&&(this._matchInfoUi||(this._matchInfoUi=new MatchInfoUI(this._socket),this._matchInfoUi.addEventListener(GameEvents.EVT_RETURN,function(){t.stage.removeChild(t._matchInfoUi)},this),this._matchInfoUi.addEventListener(GameEvents.EVT_JOIN_GAME,function(){var e=(new Date).getTime();console.log(e>=Data._match.startTime),Data.score<=0&&null!=Data._match&&void 0!=Data._match&&e>=Data._match.startTime&&e<Data._match.endTime&&(t.stage.removeChild(t._matchInfoUi),t.addChild(t._runingPage),t._multiUsergame=new Game(t._runingPage),t._multiUsergame.start(),t._runingPage.setChildIndex(t._backBtn,-1),t._runingPage.setChildIndex(t._lastCount,-1),t._time=new egret.Timer(1e3,(Data._match.endTime-Data._match.startTime)/1e3),Data.remainTime=(Data._match.endTime-e)/1e3,console.log("剩余时间还有"+Data.remainTime),t._time.addEventListener(egret.TimerEvent.TIMER,t.timerDecount,t),t._time.start(),t._socket.emit("joinGame",Data._user))},this),this._matchInfoUi.addEventListener(GameEvents.EVT_QUERY_RESULT,function(){t.cleanOldResult(),t._matchInfoUi.updateMatchList()},this),this._matchInfoUi.addEventListener(GameEvents.EVT_QUERY_BONES,function(){var e={matchId:Data._match.matchId,userName:Data._user.userName};t._socket.emit("queryCurMatchResult",e)},this)),this.stage.addChild(this._matchInfoUi))},e.prototype.cleanOldResult=function(){Data._match=null,Data._matchResult=null,Data.score=0},e.prototype.stopRuningGame=function(){if(this._time.stop(),this._time.removeEventListener(egret.TimerEvent.TIMER,this.timerDecount,this),this._lastCount.text="倒计时：60","singleUser"==this._gameType)this._singleUsergame.stopGame();else if("multiUser"==this._gameType){this._multiUsergame.stopGame();var t={matchId:Data._match.matchId,userName:Data._user.userName,result:Data.score};this._socket.emit("saveUserGameResult",t),console.log("多人游戏结束")}},e.prototype.onRegLoginBtnClick=function(){this.stage.addChild(this._regLoginPage)},e.prototype.login=function(){console.log("login click");var t=this._regLoginPage.getChildAt(3),e=this._regLoginPage.getChildAt(4);this._socket.emit("login",{userName:t.text,phone:e.text})},e.prototype.register=function(){console.log("register user");var t=this._regLoginPage.getChildAt(3),e=this._regLoginPage.getChildAt(4);this._socket.emit("register",{userName:t.text,phone:e.text})},e.prototype.retryGame=function(){"singleUser"==this._gameType&&(Data.score=0,Data.remainTime=60,this._runingPage.removeChild(this._dispValue),this._time=new egret.Timer(1e3,60),Data.remainTime=60,this._time.addEventListener(egret.TimerEvent.TIMER,this.timerDecount,this),this._time.start(),this._singleUsergame.startGame())},e.prototype.timerDecount=function(){this._lastCount.text="倒计时："+Data.remainTime.toString(),console.log("倒计时："+Data.remainTime.toString()),Data.remainTime--,Data.remainTime<=0&&this.timeOut()},e.prototype.timeOut=function(){this.stopRuningGame();var t=this._dispValue.getChildAt(3);t.text=Data.score.toString(),this._runingPage.addChild(this._dispValue)},e.prototype.onBackBtnClick=function(t){console.log("[INFO] 返回主页……"),this.removeChild(this._runingPage)},e.prototype.dispAdminPanel=function(){var t=this;this.btn4.enabled=!0,this._adminPanel||(this._adminPanel=new AdminPanel(this._socket),this._adminPanel.addEventListener(GameEvents.EVT_RETURN,function(){t.stage.removeChild(t._adminPanel)},this)),this._adminPanel.updateUi(),this.stage.addChild(this._adminPanel)},e.prototype.clearAdminPanel=function(){this.btn4.enabled=!1},e.prototype.onLoginSuccess=function(t){console.log("登陆成功："+t),Data._user=t,this.btn2.enabled=!0,"admin123"===t.userName&&"15021121315"===t.phone&&this.dispAdminPanel(),this.stage.removeChild(this._regLoginPage),this.cleanWarnMessage()},e.prototype.onRegister=function(t){console.log("注册成功："+t),Data._user=t,this.stage.removeChild(this._regLoginPage),this.cleanWarnMessage()},e.prototype.onException=function(t){console.log(t),Data._exception=new BaseException(t.name,t.message);var e=this._regLoginPage.getChildAt(7);e.text=t.message},e.prototype.onGameStop=function(t){Data._matchResult=t,this._matchInfoUi.updateMatchList(),Data._matchBegins=!1,Data._match=null,Data._matchResult=null},e.prototype.onGameBegins=function(t){Data._matchBegins=!0,Data._match=null,Data._matchResult=null,Data.score=0,this._matchInfoUi.updateMatchList()},e.prototype.onQueryCurMatchResult=function(t){var e=this;this._showValueTop||(this._showValueTop=new ShowValueTop(this._socket),this._showValueTop.addEventListener(GameEvents.EVT_RETURN,function(){e.stage.removeChild(e._showValueTop)},this)),this._showValueTop.updateUi(t),this.stage.addChild(this._showValueTop),this.cleanOldResult()},e.prototype.cleanWarnMessage=function(){var t=this._regLoginPage.getChildAt(7);t.text=null},e}(eui.UILayer);__reflect(Main.prototype,"Main");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var s=RES.getRes(t);s?n(s):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var BaseGameBg=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=new egret.Bitmap;t.texture=RES.getRes("rmb_100_jpg"),t.width=Data.getStageW(),t.height=Data.getStageH(),this.addChild(t),this._cnt=new egret.TextField,this._cnt.backgroundColor=16777215,this._cnt.border=!1,this._cnt.borderColor=65280,this._cnt.fontFamily="Arial",this._cnt.textColor=0,this._cnt.size=60,this._cnt.text="数量：0",this._cnt.x=.5*Data.getStageW(),this.addChild(this._cnt)},e.prototype.update=function(){this._cnt.text="数量："+Data.score.toString()},e}(egret.DisplayObjectContainer);__reflect(BaseGameBg.prototype,"BaseGameBg");var Data=function(){function t(){}return t.getStageW=function(){return egret.MainContext.instance.stage.stageWidth},t.getStageH=function(){return egret.MainContext.instance.stage.stageHeight},Object.defineProperty(t,"stage",{get:function(){return egret.MainContext.instance.stage},enumerable:!0,configurable:!0}),t}();Data.type=-1,Data.score=0,Data.remainTime=0,__reflect(Data.prototype,"Data");var GameEvents=function(){function t(){}return t}();GameEvents.EVT_RETURN="EVT_RETURN",GameEvents.EVT_JOIN_GAME="EVT_JOIN_GAME",GameEvents.EVT_STOP_GAME="EVT_STOP_GAME",GameEvents.EVT_QUERY_RESULT="EVT_QUERY_RESULT",GameEvents.EVT_QUERY_BONES="EVT_QUERY_BONES",GameEvents.EVT_LOAD_PAGE="EVT_LOAD_PAGE",__reflect(GameEvents.prototype,"GameEvents");var Game=function(){function t(t){this._layer=t,this.init()}return t.prototype.init=function(){this.drawBg(),this._gestureShape=new egret.Shape,this._layer.addChild(this._gestureShape),this._gesture=new Gesture,this.startGame()},t.prototype.startGame=function(){this._gesture.addEvent(this._gestureShape),Data.stage.addEventListener("gameover",this.gameover,this),Data.stage.addEventListener("counter",this.counter,this)},t.prototype.stopGame=function(){null!=this._time&&this._time.stop(),null!=this._gesture&&this._gesture.removeEvent(),Data.stage.removeEventListener("counter",this.counter,this,!0),Data.stage.removeEventListener("counter",this.counter,this,!1),Data.stage.removeEventListener("gameover",this.gameover,this,!0),Data.stage.removeEventListener("gameover",this.gameover,this,!1)},t.prototype.drawBg=function(){this._background=new BaseGameBg,this._maskBg=new BaseGameBg,this._layer.addChild(this._background),this._layer.addChild(this._maskBg)},t.prototype.start=function(){},t.prototype.create=function(t){console.info("You have move "+100*Data.score+" YUAN")},t.prototype.gameover=function(t){this._time.stop(),this._gesture.removeEvent()},t.prototype.counter=function(t){console.debug("Input type:"+Data.type),1==Data.type&&(this.moveMoney(),Data.score++),this._background.update()},t.prototype.moveMoney=function(){egret.Tween.removeTweens(this._maskBg),this.resetPostion();var t=!1,e=300,i=100,n=egret.Ease.quintInOut,s=0,a=Data.getStageW()/2,o=1,r=1,h=0,c=0,u={x:this._maskBg.x+s,y:this._maskBg.y+a,alpha:c,rotation:h,scaleX:o,scaleY:r};egret.Tween.get(this._maskBg,{loop:t}).to(u,e,n).wait(i)},t.prototype.resetPostion=function(){this._maskBg.x=0,this._maskBg.y=0,this._maskBg.scaleX=1,this._maskBg.scaleY=1,this._maskBg.rotation=0,this._maskBg.alpha=1},t}();__reflect(Game.prototype,"Game");var Gesture=function(){function t(){this._symbol=["28","46","82","64","141","585","3","7","5","1","4321876","2345678"],this._symbolG=[0,0,3,3,5,5,1,1,2,2,4,4]}return t.prototype.addEvent=function(t){this._layer=t,egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.mouseDown,this),egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.mouseUp,this),egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this)},t.prototype.removeEvent=function(){egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.mouseDown,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.mouseUp,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this)},t.prototype.mouseDown=function(t){this._layer.graphics.clear(),this._mouseDatas=[];var e=new egret.Point(t.stageX,t.stageY);this._mouseDatas.push(e),this._currentPoint=e},t.prototype.mouseMove=function(t){var e=new egret.Point(t.stageX,t.stageY);this._mouseDatas.push(e),this._layer.graphics.lineStyle(5,0),this._layer.graphics.moveTo(this._currentPoint.x,this._currentPoint.y),this._layer.graphics.lineTo(e.x,e.y),this._layer.graphics.endFill(),this._currentPoint=e},t.prototype.mouseUp=function(t){var e=new egret.Point(t.stageX,t.stageY);this._mouseDatas.push(e),this._layer.graphics.clear(),this.motion()},t.prototype.motion=function(){var t=[],e=0,i=this._mouseDatas.length;t.push(this._mouseDatas[e]);for(var n=0;i>n;n++)egret.Point.distance(this._mouseDatas[e],this._mouseDatas[n])>30&&(e=n,t.push(this._mouseDatas[e]));this._mouseDatas=t,this.parseDirection()},t.prototype.parseDirection=function(){this._dirsArr=[];for(var t=this._mouseDatas.length,e=0;t>e;e++)if(this._mouseDatas[e+1]){var i=this._mouseDatas[e],n=this._mouseDatas[e+1],s=i.y-n.y,a=egret.Point.distance(i,n),o=Math.asin(s/a),r=57.29578*o,h=this.quadrant(i,n),c=this.getDirByAngQuad(r,h);this._dirsArr.push(c)}var u=this.repDiff(this._dirsArr);console.log(u);var l=this.sweep(u);console.log("type: ",l),this.disEvent(l)},t.prototype.disEvent=function(t){Data.type=t,-1!=t&&egret.MainContext.instance.stage.dispatchEvent(new egret.Event("counter"))},t.prototype.sweep=function(t){for(var e=-1,i=-1,n=this._symbol.length,s=0;n>s;s++){var a=this.Levenshtein_Distance_Percent(this._symbol[s],t);a>i&&(i=a,e=this._symbolG[s])}return.4>i&&(e=-1),e},t.prototype.repDiff=function(t){for(var e="",i=t.length,n=0,s=0;i>s;s++)n!=t[s]&&(n=t[s],e+=t[s]);return e},t.prototype.getDirByAngQuad=function(t,e){switch(e){case 1:return 22.5>=t&&t>=0?1:67.5>=t&&t>22.5?8:7;case 2:return 22.5>=t&&t>=0?5:67.5>=t&&t>22.5?6:7;case 3:return-67.5>=t&&t>=-90?3:-22.5>=t&&t>-67.5?4:5;case 4:return-67.5>=t&&t>=-90?3:-22.5>=t&&t>-67.5?2:1}},t.prototype.quadrant=function(t,e){return e.x>=t.x?e.y<=t.y?1:4:e.y<=t.y?2:3},t.prototype.Levenshtein_Distance=function(t,e){var i,n,s,a,o,r=t.length,h=e.length,c=[];if(0==r)return h;if(0==h)return r;for(i=0;r>=i;i++)c[i]=[],c[i][0]=i;for(n=0;h>=n;n++)c[0][n]=n;for(i=1;r>=i;i++)for(s=t.charAt(i-1),n=1;h>=n;n++)a=e.charAt(n-1),o=s==a?0:1,c[i][n]=this.Minimum(c[i-1][n]+1,c[i][n-1]+1,c[i-1][n-1]+o);return c[r][h]},t.prototype.Levenshtein_Distance_Percent=function(t,e){var i=t.length>e.length?t.length:e.length,n=this.Levenshtein_Distance(t,e);return 1-n/i},t.prototype.Minimum=function(t,e,i){return e>t?i>t?t:i:i>e?e:i},t}();__reflect(Gesture.prototype,"Gesture");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var BaseException=function(){function t(t,e){this._name=t,this._message=e}return t}();__reflect(BaseException.prototype,"BaseException");var Match=function(){function t(t){this._startTime=t}return t}();__reflect(Match.prototype,"Match");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function s(t){e.call(n,t)}function a(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(t,s,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var AdminPanel=function(t){function e(e){var i=t.call(this)||this;return i._socket=e,i.addEventListener(eui.UIEvent.COMPLETE,i.uiCompHandler,i),i.skinName="resource/components/adminPanel.exml",i}return __extends(e,t),e.prototype.uiCompHandler=function(){var t=this;this.btnReturn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.dispatchEventWith(GameEvents.EVT_RETURN)},this),this.btnCreateGame.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCreateGame,this),this.btnStopGame.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStopGame,this),this.btnCleanGame.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCleanGame,this)},e.prototype.updateUi=function(){var t=new Date,e=t.getTime().toString();this.txtStartTime.text=e,this.txtMoreTime.text="30",this.txtName.text="数钱大作战-"+e,this.txtPeriod.text="60"},e.prototype.onStopGame=function(){this._socket.emit("stopMatch")},e.prototype.onCleanGame=function(){this._socket.emit("cleanMatch")},e.prototype.onCreateGame=function(){var t=+this.txtStartTime.text+1e4,e=this.txtName.text,i=1e3*+this.txtMoreTime.text,n=1e3*+this.txtPeriod.text,s=t+i,a={startTime:t,endTime:s,matchName:e,period:n};this._socket.emit("createMatch",a)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e}(eui.Component);__reflect(AdminPanel.prototype,"AdminPanel");var MatchInfoUI=function(t){function e(e){var i=t.call(this)||this;return i._socket=e,i.addEventListener(eui.UIEvent.COMPLETE,i.uiCompHandler,i),i.skinName="resource/components/matchInfoSkin.exml",i._socket.on("getMatchSuccess",i.onReceivedData.bind(i)),i}return __extends(e,t),e.prototype.uiCompHandler=function(){var t=this;console.log("		MatchInfoUI uiCompHandler"),this.btnReturn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.dispatchEventWith(GameEvents.EVT_RETURN)},this),this.btnJoinMatch.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.dispatchEventWith(GameEvents.EVT_JOIN_GAME)},this),this.btnQueryMatchRes.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.dispatchEventWith(GameEvents.EVT_QUERY_RESULT)},this),this.btnQueryBonus.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.dispatchEventWith(GameEvents.EVT_QUERY_BONES)},this)},e.prototype.updateMatchList=function(){this._socket.emit("getMatch")},e.prototype.onReceivedData=function(t){if(console.log("接收到比赛信息"),console.log(t),t&&void 0!=t.match&&null!=t.match){var e=[];e.push(t),Data._match=t.match,this.listMatchs.dataProvider=new eui.ArrayCollection(e),this.listMatchs.itemRenderer=MatchListIRSkin}else this.listMatchs.dataProvider=new eui.ArrayCollection([]),this.listMatchs.itemRenderer=MatchListIRSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e}(eui.Component);__reflect(MatchInfoUI.prototype,"MatchInfoUI");var MatchListIRSkin=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/components/matchInfoListIRSkin.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){this.txtMatchName.text=this.data.match.matchName,this.txtStartTime.text=this.data.match.startTimeString,1!=this.data.match.isRunning&&(this.btnJoinGame.enabled=!1)},e}(eui.ItemRenderer);__reflect(MatchListIRSkin.prototype,"MatchListIRSkin");var ShowValueTop=function(t){function e(e){var i=t.call(this)||this;return i._socket=e,i.addEventListener(eui.UIEvent.COMPLETE,i.uiCompHandler,i),i.skinName="resource/components/showValueTop.exml",i}return __extends(e,t),e.prototype.uiCompHandler=function(){var t=this;this.btnReturn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.dispatchEventWith(GameEvents.EVT_RETURN)},this)},e.prototype.updateUi=function(t){console.log(t),null!=t&&void 0!=t&&"index"in t&&"result"in t?null!=t?(this.txtValue.text=t.result.toString(),this.txtNameList.text="恭喜，您的成绩是第"+(t.index+1)+"位！"):this.txtNameList.text="sorry, 您的成绩不是前10位":this.txtNameList.text="sorry, 您的成绩没有入围……"},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e}(eui.Component);__reflect(ShowValueTop.prototype,"ShowValueTop");var User=function(){function t(t,e){this._userName=t,this._phone=e}return t}();__reflect(User.prototype,"User");var UserHandler=function(){function t(t){this._socket=t}return t.prototype.initHandler=function(){this._socket.on("loginSuccess",this._loginSuccessHandler),this._socket.on("registerSuccess",this._RegisterSuccessHandler),this._socket.on("exception",this._ExceptionHandler),this._socket.on("game-stop",this._GameStopHandler),this._socket.on("gameBegins",this._GameBeginsHandler),this._socket.on("queryCurMatchResultSuccess",this.queryCurMatchResult)},t.prototype.setLoginSuccessHandler=function(t){this._loginSuccessHandler=t},t.prototype.setRegisterSuccessHandler=function(t){this._RegisterSuccessHandler=t},t.prototype.setExceptionHandler=function(t){this._ExceptionHandler=t},t.prototype.setGameStopHandler=function(t){this._GameStopHandler=t},t.prototype.setGameBeginsHandler=function(t){this._GameBeginsHandler=t},t.prototype.setqueryCurMatchResult=function(t){this.queryCurMatchResult=t},t}();__reflect(UserHandler.prototype,"UserHandler");